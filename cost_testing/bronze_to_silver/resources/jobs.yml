resources:
  jobs:
    bronze_to_silver_xxs:
      name: bronze_to_silver_SQL_XXS
      tasks:
        - task_key: test_sql_xxs
          notebook_task:
            notebook_path: ../tests_sql/bronze_to_silver_sql.ipynb
            source: WORKSPACE
            warehouse_id: ${resources.sql_warehouses.SQL_XXS.id}
            base_parameters:
              schema: SQL_XXS
      tags:
        "tests": "SQL_XXS"

    bronze_to_silver_xs:
      name: bronze_to_silver_SQL_XS
      tasks:
        - task_key: test_sql_xs
          notebook_task:
            notebook_path: ../tests_sql/bronze_to_silver_sql.ipynb
            source: WORKSPACE
            warehouse_id: ${resources.sql_warehouses.SQL_XS.id}
            base_parameters:
              schema: SQL_XS
      tags:
        "tests": "SQL_XS"

    bronze_to_silver_s:
      name: bronze_to_silver_SQL_S
      tasks:
        - task_key: test_sql_s
          notebook_task:
            notebook_path: ../tests_sql/bronze_to_silver_sql.ipynb
            source: WORKSPACE
            warehouse_id: ${resources.sql_warehouses.SQL_S.id}
            base_parameters:
              schema:  SQL_S
      tags:
        "tests": "SQL_S"


    pipeline_performance_job:
      name: pipeline_performance
      tasks:
        - task_key: pipeline-task
          pipeline_task:
            pipeline_id: ${resources.pipelines.pipeline_performance.id}
      performance_target: PERFORMANCE_OPTIMIZED
      tags:
        "tests": "pipeline_performance"

    pipeline_standard_job:
      name: pipeline_standard
      tasks:
        - task_key: pipeline-task
          pipeline_task:
            pipeline_id: ${resources.pipelines.pipeline_standard.id}
      performance_target: STANDARD
      tags:
        "tests": "pipeline_standard"

    pyspark_performance_job:
      name: pyspark_performance
      tasks:
        - task_key: pipeline-task
          notebook_task:
            notebook_path: ../tests_pyspark/bronze_to_silver.ipynb
            base_parameters:
              schema: pyspark_performance
              sample_size: ${var.sample_size}
      performance_target: PERFORMANCE_OPTIMIZED
      tags:
        "tests": "pyspark_performance"

    pyspark_standard_job:
      name: pyspark_standard
      tasks:
        - task_key: pipeline-task
          notebook_task:
            notebook_path: ../tests_pyspark/bronze_to_silver.ipynb
            base_parameters:
              schema: pyspark_standard
              sample_size: ${var.sample_size}
      performance_target: STANDARD
      tags:
        "tests": "pyspark_standard"