{
  "datasets" : [ {
    "name" : "4b269011",
    "displayName" : "10_bln_bronze_to_silver",
    "query" : "with CTE AS (\n  SELECT\n    u.custom_tags,\n    SUM(u.usage_quantity * p.pricing.default) AS total\n  FROM\n    system.billing.usage u\n      RIGHT JOIN system.billing.list_prices p\n        ON u.sku_name = p.sku_name\n        AND (\n          (u.usage_start_time BETWEEN p.price_start_time AND p.price_end_time)\n          OR (\n            (u.usage_start_time > p.price_start_time)\n            AND (p.price_end_time IS NULL)\n          )\n        )\n  WHERE\n    map_contains_key(u.custom_tags, 'tests') AND\n    date(u.usage_start_time) = date'2025-04-27' -- date of 10 bln test\n  GROUP BY\n    u.custom_tags\n  ORDER BY\n    total ASC\n)\nSELECT\n  concat_ws(': ', row_number() OVER (ORDER BY total ASC), custom_tags['tests']) as rank,\n  total\nFROM\n  CTE"
  } ],
  "pages" : [ {
    "name" : "826c1622",
    "displayName" : "tests results",
    "layout" : [ {
      "widget" : {
        "name" : "ae8d286f",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "4b269011",
            "fields" : [ {
              "name" : "sum(total)",
              "expression" : "SUM(`total`)"
            }, {
              "name" : "rank",
              "expression" : "`rank`"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 3,
          "widgetType" : "bar",
          "encodings" : {
            "x" : {
              "fieldName" : "sum(total)",
              "scale" : {
                "type" : "quantitative"
              },
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              },
              "displayName" : "total"
            },
            "y" : {
              "fieldName" : "rank",
              "scale" : {
                "type" : "categorical",
                "sort" : {
                  "by" : "natural-order"
                }
              },
              "axis" : {
                "hideLabels" : false
              },
              "displayName" : "rank"
            },
            "label" : {
              "show" : true
            }
          },
          "frame" : {
            "title" : "results 10 bln bronze to silver",
            "showTitle" : true
          },
          "mark" : {
            "colors" : [ "#d5220e", {
              "themeColorType" : "visualizationColors",
              "position" : 2
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 3
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 4
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 5
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 6
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 7
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 8
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 9
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 10
            } ],
            "layout" : "group"
          }
        }
      },
      "position" : {
        "x" : 0,
        "y" : 0,
        "width" : 3,
        "height" : 6
      }
    } ]
  } ]
}